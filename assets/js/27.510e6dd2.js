(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{365:function(t,a,s){"use strict";s.r(a);var n=s(9),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("ç›¸ä¿¡å¤§å®¶å¯¹ docker éƒ½æœ‰æ‰€äº†è§£ï¼ŒğŸ˜ â€‹æˆ–æ—©å·²è½»è½¦ç†Ÿè·¯äº†ã€‚é‚£æˆ‘ä»¬å°±ç›´å¥”ä¸»é¢˜ã€‚è¿™é‡Œä¹‹æ‰€ä»¥è¦å®¹å™¨åŒ–ï¼Œç›®æ ‡æ˜¯æƒ³å€ŸåŠ© k8s çš„å®¹å™¨ç¼–æ’åœ¨å¤šä¸ªèŠ‚ç‚¹é—´æ¥ç®¡ç†å’Œè¿ç»´é”™ç»¼å¤æ‚çš„åº”ç”¨å…³ç³»ã€‚å½“ç„¶æˆ‘ä»¬ç¦»ä½¿ç”¨ k8s è¿˜æœ‰ä¸€å®šçš„è·ç¦»ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆè¿ˆå‡ºå®¹å™¨åŒ–è¿™ä¸€å°æ­¥ã€‚")]),t._v(" "),s("p",[t._v("è¿™é‡Œä»¥ spring é¡¹ç›®ä¸ºä¾‹ã€‚")]),t._v(" "),s("h2",{attrs:{id:"ç¼–å†™-dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™-dockerfile"}},[t._v("#")]),t._v(" ç¼–å†™ Dockerfile")]),t._v(" "),s("p",[t._v("Dockerfile æ˜¯ docker ç”¨æ¥å®šä¹‰å¦‚ä½•æ‰“åŒ…å®¹å™¨é•œåƒçš„å‘½ä»¤é›†åˆã€‚å†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" openjdk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("jdk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("alpine\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /app\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ARG")]),t._v(" JAR_FILE=target/*.jar\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("JAR_FILE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" app.jar\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 9091\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENTRYPOINT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sh"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-c"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"java -jar ./app.jar ${0} ${@}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("ol",[s("li",[t._v("FROM å‘½ä»¤çš„ä½œç”¨æ˜¯æŒ‡å®šåœ¨å“ªä¸ªå·²æœ‰çš„é•œåƒä¸Šè¿›è¡Œæ‰“åŒ…ï¼Œè¿™é‡Œæˆ‘ä»¬æ˜¯æ‰“åŒ… Java é¡¹ç›®ï¼Œè‡ªç„¶éœ€è¦åœ¨ jdk ç¯å¢ƒä¸Šè¿›è¡Œæ‰“åŒ…ã€‚alpine ç‰ˆæœ¬é€šå¸¸æ˜¯æŒ‡ç²¾ç®€è¿‡çš„é•œåƒç‰ˆæœ¬ï¼Œé€‚ç”¨äºäºŒæ¬¡æ‰“åŒ…çš„éœ€æ±‚")]),t._v(" "),s("li",[t._v("WORKDIR å‘½ä»¤çš„ä½œç”¨æ˜¯å®šä¹‰å·¥ä½œç›®å½•ï¼Œå¾€åçš„å‘½ä»¤éƒ½ä¼šåœ¨æ‰€å®šä¹‰çš„å·¥ä½œç›®å½•ä¸‹è¿è¡Œ")]),t._v(" "),s("li",[t._v("ARG å£°æ˜å‚æ•°ï¼Œå¯ä»¥åœ¨ä½¿ç”¨ docker build çš„æ—¶å€™ä¼ é€’å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯ä»¥é€šè¿‡ =target/*.jar æ¥å£°æ˜é»˜è®¤å€¼")]),t._v(" "),s("li",[t._v("COPY å‘½ä»¤ç”¨äºå°†æ‰“åŒ…ä¸Šä¸‹æ–‡ä¸­çš„å†…å®¹æ‹·è´åˆ°é•œåƒä¸­")]),t._v(" "),s("li",[t._v("EXPOSE æ— å®é™…ä½œç”¨ï¼Œç±»ä¼¼æ³¨é‡Šçš„å­˜åœ¨ï¼Œä»…ä»…å‘Šè¯‰ä½ å½“å‰åº”ç”¨å·¥ä½œåœ¨ 9091 ç«¯å£")]),t._v(" "),s("li",[t._v("ENTRYPOINT å®šä¹‰å®¹å™¨è¿è¡Œæ—¶æ‰€æ‰§è¡Œçš„å‘½ä»¤ä»¥åŠå‘½ä»¤å‚æ•°ï¼›${0}${@} å‡æ˜¯å ä½ç¬¦ï¼Œ${0} æŒ‡åœ¨ docker run æ—¶æœ€åé¢è·Ÿçš„ cmd è¡¥å……åˆ°å½“å‰ä½ç½®ï¼Œ${@} æŒ‡å°† docker run cmd ä¹‹åçš„æ‰€æœ‰å‚æ•°éƒ½è¡¥å……åˆ°å½“å‰ä½ç½®ã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("è¿™é‡Œä½¿ç”¨ ${0} ${@} æ¥ä¼ é€’å‘½ä»¤å’Œå‘½ä»¤å‚æ•°æ˜¯è´´è¿‘ supervisor çš„åšæ³•ã€‚å¦‚ supervisor ä¸­æˆ‘ä»¬ä¼šé€šè¿‡ java -jar xxx.jar --spring.profiles.active=prod æ¥ä¼ é€’å‚æ•°ï¼Œå®¹å™¨åŒ–åæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡ç±»ä¼¼çš„ docker run -p 9091:9091 -d --name xxxx-server xxxx-server:latest --spring.profiles.active=prod çš„æ–¹å¼æ¥å¯åŠ¨å®¹å™¨ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ openjdk:8u252-jre-slim æ¥æ›¿æ¢ openjdk:8-jdk-alpineï¼Œå¯ä»¥è¿›ä¸€æ­¥ç¼©å°é•œåƒä½“ç§¯ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"docker-build"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-build"}},[t._v("#")]),t._v(" docker build")]),t._v(" "),s("p",[t._v("æœ‰äº† Dockerfile åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ docker build æ¥æ‰“åŒ…é•œåƒäº†ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šå°† Dockerfile æ–‡ä»¶æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ã€‚å¦‚ä¸‹ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"/image/project-directory.jpg",alt:"project-directory"}})]),t._v(" "),s("p",[t._v("æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ cd åˆ° spring-demo ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ "),s("code",[t._v("docker build -t spring-demo:1.0-SHAPSHOT .")]),t._v("ï¼ŒğŸ˜© å¦‚æ— æ„å¤–ä½ ä¼šç¿»è½¦ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"/image/docker-build-failed.jpg",alt:"docker-build-failed"}})]),t._v(" "),s("p",[t._v("è¿™é‡Œæˆ‘ä»¬ COPY å‘½ä»¤æ˜¯å°† target/ ç›®å½•ä¸‹çš„å¯æ‰§è¡Œ jar æ‹·è´åˆ°é•œåƒä¸­ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œ docker build ä¹‹å‰éœ€è¦å…ˆ package ä¸€ä¸‹ï¼Œç¡®ä¿ target æ–‡ä»¶å¤¹ä¸‹å·²ç»å­˜åœ¨å¯æ‰§è¡Œ jar äº†ã€‚å¦‚ä¸‹æ˜¯å·²ç»æ‰“å¥½çš„é•œåƒã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"/image/docker-images.jpg",alt:"docker-images"}})]),t._v(" "),s("p",[t._v("å½“ç„¶ç›´æ¥é€šè¿‡ "),s("code",[t._v("docker build")]),t._v(" æ–¹å¼è¿˜ä¸å¤Ÿæ–¹ä¾¿ï¼Œæœ‰æ—¶ä¼šé—å¿˜ package è¿™ä¸ªæ“ä½œï¼Œè€Œä¸”è¿˜è¦æ‰‹åŠ¨æ‰“ tagã€‚ğŸŒŸ â€‹æ­¤æ—¶èªæ˜çš„ Java ç¨‹åºå‘˜å°±ä¼šå¯»æ‰¾ maven æ’ä»¶äº†ï¼Œåªè¦æˆ‘ä»¬å°† build è¿™ä¸ªæ“ä½œè·Ÿ package ç”Ÿå‘½å‘¨æœŸç»‘å®šåœ¨ä¸€èµ·ä¸å°±å¯ä»¥äº†å—ã€‚")]),t._v(" "),s("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šä½¿ç”¨ "),s("code",[t._v("dockerfile-maven-plugin")]),t._v(" æ’ä»¶æ¥ä»£æ›¿ docker buildã€‚")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("docker.repository")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("harbor.[your-domain].com"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("docker.repository")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("docker.image.prefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("my-project"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("docker.image.prefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.spotify"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dockerfile-maven-plugin"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${dockerfile-maven-version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("executions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("execution")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("default"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("goals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("goal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("build"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("goal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- <goal>push</goal> --\x3e")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("goals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("execution")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("executions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("repository")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${docker.repository}/${docker.image.prefix}/${project.artifactId}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("repository")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("tag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${project.version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("tag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("buildArgs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("JAR_FILE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("target/${project.build.finalName}.jar"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("JAR_FILE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("buildArgs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("useMavenSettingsForAuth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("useMavenSettingsForAuth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("å…³äº "),s("code",[t._v("dockerfile-maven-plugin")]),t._v(" çš„ä½¿ç”¨æˆ‘ä»¬ä¸åšè¿‡å¤šçš„èµ˜è¿°ï¼Œå¦‚æœ‰ç–‘é—® "),s("a",{attrs:{href:"https://github.com/spotify/dockerfile-maven",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‡ºé—¨å·¦è½¬!!!"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ harbor.[your-domain].comï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸ºå®¹å™¨å‡†å¤‡çš„ç§åº“ã€‚æˆ‘ä»¬çš„é•œåƒåœ¨æœ¬åœ°è°ƒè¯•å®Œæˆåï¼Œå¯ä»¥ç›´æ¥ push åˆ°ç§åº“ã€‚å½“ç„¶ push ä¹‹å‰ä½ éœ€è¦å–å¾— harbor è´¦æˆ·ã€‚å…³äº harbor å¦‚ä½•å®‰è£…éƒ¨ç½²ï¼Œå¯è‡ªè¡Œ googleï¼Œå°† [your-domain] æ›¿æ¢æˆä½ çš„ harbor è®¿é—®åŸŸåå³å¯ã€‚")]),t._v(" "),s("p",[s("code",[t._v("<useMavenSettingsForAuth>true</useMavenSettingsForAuth>")]),t._v(" è¿™é‡Œå£°æ˜ä½¿ç”¨ Maven settings æ–¹å¼ç™»å½•ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°†è´¦æˆ·é…ç½®åœ¨ Maven settings.xml ä¸­ã€‚")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("harbor.[your-domain].com"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("menfre"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("********"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("OKï¼Œå¦‚æ— æ„å¤–ä½ ä¼šæˆåŠŸå°†é•œåƒæ¨é€åˆ° harbor, æ—¥åä½ åªéœ€è¦åœ¨ä»»æ„æœåŠ¡å™¨ docker login and docker pull å°±å¯ä»¥å°†é•œåƒæ‹‰å–ä¸‹æ¥æ‰§è¡Œäº†ã€‚")]),t._v(" "),s("h3",{attrs:{id:"dockerignore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerignore"}},[t._v("#")]),t._v(" .dockerignore")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æ‰“åŒ…é•œåƒæ—¶å¯ä»¥åœ¨æ ¹ç›®å½•ç¼–è¾‘ä¸€ä¸ª .dockerignoreã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨æ‰“åŒ…æ—¶å°†ä¸å¿…è¦çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹è¿‡æ»¤æ‰ï¼Œé¿å…å‘é€ç»™ docker deamon çš„æ‰“åŒ…ä¸Šä¸‹æ–‡è¿‡å¤§ã€‚(docker å®é™…æ˜¯ä¸€ä¸ª cs ç»“æ„ï¼Œå…¶ä¸­åŒ…å«  dockerctl å’Œ deamonï¼Œdocker build æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå°†æŒ‡å®šçš„ä¸Šä¸‹æ–‡æ•´ä¸ªå‘é€ç»™ deamon å®Œæˆæ‰“åŒ…)")]),t._v(" "),s("blockquote",[s("p",[t._v("NOTE: åœ¨ä½¿ç”¨ç§åº“å‰ï¼Œéœ€è¦å…ˆå°†ç§åº“é…ç½®åœ¨ docker çš„ daemon.json ä¸­ã€‚ç„¶åé€šè¿‡ "),s("code",[t._v("docker login harbor.[your-domain].com")]),t._v(" å®Œæˆç™»å½•ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"docker-run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-run"}},[t._v("#")]),t._v(" docker run")]),t._v(" "),s("p",[t._v("æœ‰äº†é•œåƒä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–¹ä¾¿çš„åˆ†å‘å’Œè¿è¡Œå®¹å™¨å•¦ã€‚")]),t._v(" "),s("p",[t._v("å‡è®¾æˆ‘ä»¬å·²ç»å°†é•œåƒæ¨é€åˆ°æˆ‘ä»¬çš„ç§åº“ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥ harbor.[your-domain].com/my-project/spring-demo:1.0-SNAPSHOT ä¸ºä¾‹ã€‚")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("docker run -d --network"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host --name spring-demo harbor."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("your-domain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(".com/my-project/spring-demo:1.0-SNAPSHOT --spring.profiles.active"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("container\n")])])]),s("ol",[s("li",[t._v("-d åå°è¿è¡Œ")]),t._v(" "),s("li",[t._v("--network=host è®¾ç½®ä¸å®¿ä¸»æœºåŒä¸ª network namespace")]),t._v(" "),s("li",[t._v("--name å®¹å™¨å–åä¸º spring-demo")]),t._v(" "),s("li",[t._v("--spring.profiles.active=containerï¼ŒæŒ‡å®š spring profile ä¸º containerï¼Œè¿™é‡Œå¯ä»¥ä¸º spring é¡¹ç›®æŒ‡å®šä»»æ„é…ç½®å‚æ•°")])]),t._v(" "),s("p",[t._v("æŸ¥çœ‹æ—¥å¿—å¯ä»¥é€šè¿‡ "),s("code",[t._v("docker logs -f [å®¹å™¨ID]")]),t._v(" å‘½ä»¤ã€‚")]),t._v(" "),s("p",[t._v("çœ‹åˆ°è¿™æ­å–œä½ ï¼Œè¿ˆå‡ºäº†å®¹å™¨åŒ–çš„ä¸€å°æ­¥ã€‚ğŸ‘ ğŸ‘ ğŸ‘")]),t._v(" "),s("comment"),t._v(" "),s("comment")],1)}),[],!1,null,null,null);a.default=e.exports}}]);